# 财报测试指南

## 📋 当前状态
✅ 项目依赖已安装
✅ 测试脚本已创建
✅ 目录结构已准备好
⏳ 等待上传10份财报PDF

## 🚀 快速开始（3步）

### 第1步：上传你的10份财报

将你的财报PDF文件复制到以下目录：
```bash
/Users/zhou/Code/PDFLLM/data/uploads/
```

**方式A - 使用命令行**：
```bash
# 如果你的财报在某个文件夹，比如 ~/Documents/财报/
cp ~/Documents/财报/*.pdf /Users/zhou/Code/PDFLLM/data/uploads/
```

**方式B - 使用Finder**：
1. 打开 Finder
2. 前往文件夹：/Users/zhou/Code/PDFLLM/data/uploads/
3. 将PDF文件拖进去

### 第2步：运行测试脚本

```bash
cd /Users/zhou/Code/PDFLLM

# 激活虚拟环境
source venv/bin/activate

# 运行测试
python scripts/test_extraction.py
```

### 第3步：查看结果

测试完成后，会生成以下文件：

```
data/outputs/test_results/
├── <财报1>_extracted.json    # 提取的数据
├── <财报2>_extracted.json
├── ...
└── test_report_YYYYMMDD_HHMMSS.json  # 汇总报告
```

## 📊 测试脚本会做什么？

对每份财报，脚本会：
1. ✅ 提取所有文本内容
2. ✅ 提取所有表格
3. ✅ 统计页数、表格数
4. ✅ 记录提取准确度
5. ✅ 保存为JSON格式
6. ✅ 生成汇总报告

## 📈 预期输出示例

```
============================================================
正在处理: 某公司2023年年报.pdf
============================================================
  表格 1: 第5页, 行数=20, 准确度=0.95
  表格 2: 第10页, 行数=15, 准确度=0.88
  表格 3: 第12页, 行数=30, 准确度=0.92
✅ 成功! 提取了 3 个表格

============================================================
测试汇总报告
============================================================
✅ 成功: 10/10
❌ 失败: 0/10
📊 总表格数: 45
📄 总页数: 500
⏱️  总耗时: 120.5秒
```

## 🔍 测试结果分析指标

测试完成后，关注以下指标：

### 成功率
- **目标**: >90%
- **如果<90%**: 检查失败的文件，可能是扫描件或加密PDF

### 表格提取数量
- **预期**: 每份财报 5-20 个表格（根据实际情况）
- **如果过少**: 可能需要增强提取器（加Camelot）
- **如果为0**: 可能是扫描件，需要OCR

### 表格准确度
- **优秀**: >0.9
- **良好**: 0.8-0.9
- **需改进**: <0.8

## ⚠️ 常见问题

### Q1: 提示"No module named 'src'"
```bash
# 确保在项目根目录
cd /Users/zhou/Code/PDFLLM
# 重新运行
python scripts/test_extraction.py
```

### Q2: Camelot报错找不到Ghostscript
```bash
# macOS安装Ghostscript
brew install ghostscript
```

### Q3: 表格数量为0
- **原因1**: PDF是扫描件（需要OCR）
- **原因2**: 表格没有边框（pdfplumber识别不了）
- **解决**: 下一步我们会增加Camelot提取器

### Q4: 提取很慢
- **正常速度**: 每页1-2秒
- **如果过慢**: 可能是PDF很大或包含大量图片
- **优化**: 下一阶段可以加入多线程

## 📝 测试后的操作清单

测试完成后，请检查：

- [ ] 成功率是否>80%?
- [ ] 提取的表格数量是否符合预期?
- [ ] 查看1-2份提取的JSON，数据是否准确?
- [ ] 记录主要问题类型（扫描件、无边框表格、跨页等）

## 🎯 下一步计划

根据测试结果，我们会：

**如果效果好（准确率>85%）**:
1. ✅ MVP验证成功
2. 开始建索引和检索模块

**如果效果一般（60-85%）**:
1. 增加Camelot双模式提取
2. 优化表格识别参数
3. 重新测试

**如果效果差（<60%）**:
1. 检查是否大量扫描件
2. 考虑加入OCR（PaddleOCR）
3. 评估是否需要商业API

---

## 🆘 需要帮助？

如果遇到任何问题，提供以下信息：
1. 错误信息截图
2. 测试报告JSON内容
3. 样本财报的特征（矢量/扫描、中文/英文、格式等）

准备好了吗？上传PDF文件，然后运行测试！🚀
